<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dew Stella Chan">
<meta name="dcterms.date" content="2024-09-27">

<title>Take-Home Exercise 2 â€“ ISSS622-GAA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS622-GAA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/hands-on_ex01/hands-on_ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/hands-on_ex02/hands-on_ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/hands-on_ex03/hands-on_ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/hands-on_ex04/hands-on_ex04.html">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/hands-on_ex05/hands-on_ex05.html">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/hands-on_ex06/hands-on_ex06.html">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-Class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In_Class_Ex/In_Class_Ex01/In_Class_Ex01.html">
 <span class="dropdown-text">In Class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In_Class_Ex/In_Class_Ex03/In_Class_Ex03.html">
 <span class="dropdown-text">In Class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In_Class_Ex/In_Class_Ex04/In_Class_Ex04.html">
 <span class="dropdown-text">In Class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In_Class_Ex/In_Class_Ex05/In_Class_Ex05.html">
 <span class="dropdown-text">In Class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In_Class_Ex/In_Class_Ex06/In_Class_Ex06.html">
 <span class="dropdown-text">In Class Exercise 6</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-Home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take_home_Ex/Take_home_01/Take_home_01.html">
 <span class="dropdown-text">Take Home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take_home_Ex/Take_home_02/Take_home_02.html">
 <span class="dropdown-text">Take Home Exercise 2</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#take-home-exercise-02" id="toc-take-home-exercise-02" class="nav-link active" data-scroll-target="#take-home-exercise-02">Take Home Exercise 02</a>
  <ul class="collapse">
  <li><a href="#loading-of-libraries." id="toc-loading-of-libraries." class="nav-link" data-scroll-target="#loading-of-libraries.">Loading of Libraries.</a></li>
  <li><a href="#data-preparation-and-transformation" id="toc-data-preparation-and-transformation" class="nav-link" data-scroll-target="#data-preparation-and-transformation">Data preparation and Transformation</a>
  <ul class="collapse">
  <li><a href="#loading-of-thailand---subnational-administrative-boundaries" id="toc-loading-of-thailand---subnational-administrative-boundaries" class="nav-link" data-scroll-target="#loading-of-thailand---subnational-administrative-boundaries">Loading of Thailand - Subnational Administrative Boundaries</a></li>
  <li><a href="#writing-and-reading-the-data-to-rds-folder" id="toc-writing-and-reading-the-data-to-rds-folder" class="nav-link" data-scroll-target="#writing-and-reading-the-data-to-rds-folder">writing and reading the data to rds folder</a></li>
  </ul></li>
  <li><a href="#thailand-domestic-tourism-statistics" id="toc-thailand-domestic-tourism-statistics" class="nav-link" data-scroll-target="#thailand-domestic-tourism-statistics">Thailand Domestic Tourism Statistics</a>
  <ul class="collapse">
  <li><a href="#data-transformation" id="toc-data-transformation" class="nav-link" data-scroll-target="#data-transformation">Data Transformation</a></li>
  <li><a href="#joining-the-aspatial-long-data-to-geospatial-data" id="toc-joining-the-aspatial-long-data-to-geospatial-data" class="nav-link" data-scroll-target="#joining-the-aspatial-long-data-to-geospatial-data">Joining the aspatial long data to geospatial data:</a></li>
  </ul></li>
  <li><a href="#to-derive-foreign-related-spending-for-for-the-study-period." id="toc-to-derive-foreign-related-spending-for-for-the-study-period." class="nav-link" data-scroll-target="#to-derive-foreign-related-spending-for-for-the-study-period.">To Derive Foreign related spending for for the study period.</a></li>
  <li><a href="#visualising-year-2019-to-2023-by-variables" id="toc-visualising-year-2019-to-2023-by-variables" class="nav-link" data-scroll-target="#visualising-year-2019-to-2023-by-variables">Visualising year 2019 to 2023 by Variables</a></li>
  </ul></li>
  <li><a href="#analyising-if-tourist-hotspot-is-related-to-space" id="toc-analyising-if-tourist-hotspot-is-related-to-space" class="nav-link" data-scroll-target="#analyising-if-tourist-hotspot-is-related-to-space">Analyising if Tourist hotspot is related to space</a>
  <ul class="collapse">
  <li><a href="#calculating-using-the-distance-based-matrix" id="toc-calculating-using-the-distance-based-matrix" class="nav-link" data-scroll-target="#calculating-using-the-distance-based-matrix">Calculating using the distance based matrix:</a>
  <ul class="collapse">
  <li><a href="#fixed-distance-matrix" id="toc-fixed-distance-matrix" class="nav-link" data-scroll-target="#fixed-distance-matrix">Fixed Distance Matrix:</a></li>
  <li><a href="#adaptive-distanace-weight-martix" id="toc-adaptive-distanace-weight-martix" class="nav-link" data-scroll-target="#adaptive-distanace-weight-martix">Adaptive Distanace weight martix</a></li>
  <li><a href="#plotting-adaptive-distance-based-neighbours" id="toc-plotting-adaptive-distance-based-neighbours" class="nav-link" data-scroll-target="#plotting-adaptive-distance-based-neighbours">Plotting Adaptive Distance-based Neighbours</a></li>
  <li><a href="#weights-based-on-idw" id="toc-weights-based-on-idw" class="nav-link" data-scroll-target="#weights-based-on-idw">Weights based on IDW</a></li>
  <li><a href="#row-standardised-weights-martix" id="toc-row-standardised-weights-martix" class="nav-link" data-scroll-target="#row-standardised-weights-martix">Row-Standardised Weights martix</a></li>
  <li><a href="#a-row-standardised-distance-weight-matrix-by-using-the-code-chunk-below." id="toc-a-row-standardised-distance-weight-matrix-by-using-the-code-chunk-below." class="nav-link" data-scroll-target="#a-row-standardised-distance-weight-matrix-by-using-the-code-chunk-below.">a row standardised distance weight matrix by using the code chunk below.</a></li>
  </ul></li>
  <li><a href="#spatial-lag-with-row-standardized-weights" id="toc-spatial-lag-with-row-standardized-weights" class="nav-link" data-scroll-target="#spatial-lag-with-row-standardized-weights">Spatial lag with row-standardized weights</a></li>
  <li><a href="#hot-spot-area-analysis" id="toc-hot-spot-area-analysis" class="nav-link" data-scroll-target="#hot-spot-area-analysis">5.2.2 Hot Spot Area Analysis</a></li>
  <li><a href="#gi-statistics-using-fixed-distance" id="toc-gi-statistics-using-fixed-distance" class="nav-link" data-scroll-target="#gi-statistics-using-fixed-distance">Gi statistics using fixed distance</a>
  <ul class="collapse">
  <li><a href="#gi-statistics-using-adaptive-distance" id="toc-gi-statistics-using-adaptive-distance" class="nav-link" data-scroll-target="#gi-statistics-using-adaptive-distance">Gi statistics using adaptive distance</a></li>
  </ul></li>
  <li><a href="#time-series" id="toc-time-series" class="nav-link" data-scroll-target="#time-series">Time Series</a>
  <ul class="collapse">
  <li><a href="#emergering-hotspot" id="toc-emergering-hotspot" class="nav-link" data-scroll-target="#emergering-hotspot">Emergering Hotspot</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-Home Exercise 2</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dew Stella Chan </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 27, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">October 13, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="take-home-exercise-02" class="level1">
<h1>Take Home Exercise 02</h1>
<section id="loading-of-libraries." class="level2">
<h2 class="anchored" data-anchor-id="loading-of-libraries.">Loading of Libraries.</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, sp, sfdep, raster, spatstat, tmap, tidyverse, lubridate, readxl, spNetwork, plotly, tidyverse, Kendall,  knitr, spdep, patchwork)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>) <span class="co">#set seed to ensure the result is consistent</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-preparation-and-transformation" class="level2">
<h2 class="anchored" data-anchor-id="data-preparation-and-transformation">Data preparation and Transformation</h2>
<section id="loading-of-thailand---subnational-administrative-boundaries" class="level3">
<h3 class="anchored" data-anchor-id="loading-of-thailand---subnational-administrative-boundaries">Loading of Thailand - Subnational Administrative Boundaries</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|eval: false</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>SAB_1 <span class="ot">=</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data"</span>, <span class="at">layer =</span> <span class="st">"tha_admbnda_adm1_rtsd_20220121"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">32647</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `tha_admbnda_adm1_rtsd_20220121' from data source 
  `C:\dewschan\ISSS622-GAA\Take_home_Ex\Take_home_02\data' using driver `ESRI Shapefile'
Simple feature collection with 77 features and 16 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 97.34336 ymin: 5.613038 xmax: 105.637 ymax: 20.46507
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
</section>
<section id="writing-and-reading-the-data-to-rds-folder" class="level3">
<h3 class="anchored" data-anchor-id="writing-and-reading-the-data-to-rds-folder">writing and reading the data to rds folder</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(SAB_1,<span class="st">"data/rds/SAB_1.rds"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#to save the file to rds</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#re-reading the acc file to the environments</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>SAB_1<span class="ot">&lt;-</span><span class="fu">read_rds</span>(<span class="st">"data/rds/SAB_1.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Given that Phunket is a offshore island from the Thailand Mainland, the focus of this analysis will be on using on distance based matrix</p>
</section>
</section>
<section id="thailand-domestic-tourism-statistics" class="level2">
<h2 class="anchored" data-anchor-id="thailand-domestic-tourism-statistics">Thailand Domestic Tourism Statistics</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>Tour_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/thailand_domestic_tourism_2019_2023_ver2.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Standardizing the Province Names</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>Tour_data <span class="ot">&lt;-</span> Tour_data <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">province_eng =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    province_eng <span class="sc">==</span> <span class="st">"Buriram"</span> <span class="sc">~</span> <span class="st">"Buri Ram"</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    province_eng <span class="sc">==</span> <span class="st">"Chainat"</span> <span class="sc">~</span> <span class="st">"Chai Nat"</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    province_eng <span class="sc">==</span> <span class="st">"Chonburi"</span> <span class="sc">~</span> <span class="st">"Chon Buri"</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    province_eng <span class="sc">==</span> <span class="st">"Lopburi"</span> <span class="sc">~</span> <span class="st">"Lop Buri"</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    province_eng <span class="sc">==</span> <span class="st">"Nong Bua Lamphu"</span> <span class="sc">~</span> <span class="st">"Nong Bua Lam Phu"</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    province_eng <span class="sc">==</span> <span class="st">"Phang Nga"</span> <span class="sc">~</span> <span class="st">"Phangnga"</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    province_eng <span class="sc">==</span> <span class="st">"Prachinburi"</span> <span class="sc">~</span> <span class="st">"Prachin Buri"</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    province_eng <span class="sc">==</span> <span class="st">"Sisaket"</span> <span class="sc">~</span> <span class="st">"Si Sa Ket"</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> province_eng</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>Tour_data <span class="ot">&lt;-</span><span class="fu">rename</span>(Tour_data, <span class="at">ADM1_EN =</span> province_eng, <span class="at">Date_tour =</span> date )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="writing-and-reading-the-data-in-tourism-statistics-to-rds-folder" class="level4">
<h4 class="anchored" data-anchor-id="writing-and-reading-the-data-in-tourism-statistics-to-rds-folder">writing and reading the data in Tourism Statistics to rds folder</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(Tour_data,<span class="st">"data/rds/Tour_data.rds"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#to save the file to rds</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>Tour_data<span class="ot">&lt;-</span><span class="fu">read_rds</span>(<span class="st">"data/rds/Tour_data.rds"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#re-reading the acc file to the environments</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-transformation" class="level3">
<h3 class="anchored" data-anchor-id="data-transformation">Data Transformation</h3>
<p>Transform tour data from long table into a table with the 8 different indicators in the variables column into individual column for data analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>tour_data_wide <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(Tour_data, <span class="at">names_from =</span> <span class="st">"variable"</span>, <span class="at">values_from =</span> <span class="st">"value"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(tour_data_wide,<span class="st">"data/rds/tour_data_wide.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="reading-the-wide-data-in-tourism-statistics-from-rds-folder" class="level5">
<h5 class="anchored" data-anchor-id="reading-the-wide-data-in-tourism-statistics-from-rds-folder">reading the wide data in Tourism Statistics from rds folder:</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#re-reading the acc file to the environments</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>tour_data_wide<span class="ot">&lt;-</span><span class="fu">read_rds</span>(<span class="st">"data/rds/tour_data_wide.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="joining-the-aspatial-long-data-to-geospatial-data" class="level3">
<h3 class="anchored" data-anchor-id="joining-the-aspatial-long-data-to-geospatial-data">Joining the aspatial long data to geospatial data:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>SAB1_tour_wide <span class="ot">&lt;-</span> <span class="fu">left_join</span>(SAB_1, tour_data_wide)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(SAB1_tour_wide,<span class="st">"data/rds/SAB1_tour_wide.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="reading-the-joined-aspatial-and-geospatial-data-from-rds-folder" class="level4">
<h4 class="anchored" data-anchor-id="reading-the-joined-aspatial-and-geospatial-data-from-rds-folder">Reading the joined aspatial and geospatial data from rds folder:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>SAB1_tour_wide<span class="ot">&lt;-</span><span class="fu">read_rds</span>(<span class="st">"data/rds/SAB1_tour_wide.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="to-derive-foreign-related-spending-for-for-the-study-period." class="level2">
<h2 class="anchored" data-anchor-id="to-derive-foreign-related-spending-for-for-the-study-period.">To Derive Foreign related spending for for the study period.</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>total_for_prov<span class="ot">&lt;-</span> tour_data_wide <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ADM1_EN) <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_for_revenue =</span> <span class="fu">sum</span>(revenue_foreign), <span class="at">total_no_for_tourist=</span> <span class="fu">sum</span>(no_tourist_foreign))<span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Amt_rev_per_for_tourist=</span> (total_for_revenue <span class="sc">/</span>total_no_for_tourist))</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(total_for_prov,<span class="st">"data/rds/total_for_prov.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>SAB_1_total_for_prov<span class="ot">&lt;-</span> <span class="fu">left_join</span>(SAB_1, total_for_prov)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(SAB_1_total_for_prov,<span class="st">"data/rds/SAB_1_total_for_prov.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="to-read-the-data-from-sab_1-layer-rds-folder." class="level4">
<h4 class="anchored" data-anchor-id="to-read-the-data-from-sab_1-layer-rds-folder.">To read the data from SAB_1 layer rds folder.</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>SAB_1_total_for_prov<span class="ot">&lt;-</span><span class="fu">read_rds</span>(<span class="st">"data/rds/SAB_1_total_for_prov.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="to-read-the-data-from-thai_total_for_prov-layer-rds-folder." class="level4">
<h4 class="anchored" data-anchor-id="to-read-the-data-from-thai_total_for_prov-layer-rds-folder.">To read the data from Thai_total_for_prov layer rds folder.</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>Thai_total_for_prov <span class="ot">&lt;-</span> <span class="fu">subset</span>(SAB_1_total_for_prov , </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">select =</span> <span class="fu">c</span>(<span class="st">"Shape_Leng"</span>, <span class="st">"Shape_Area"</span>, </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"ADM1_EN"</span>,<span class="st">"date"</span>, <span class="st">"total_for_revenue"</span>, </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"total_no_for_tourist"</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"Amt_rev_per_for_tourist"</span>, <span class="st">"geometry"</span>))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(Thai_total_for_prov,<span class="st">"data/rds/Thai_total_for_prov.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>Thai_total_for_prov<span class="ot">&lt;-</span><span class="fu">read_rds</span>(<span class="st">"data/rds/Thai_total_for_prov.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="visualising-year-2019-to-2023-by-variables" class="level2">
<h2 class="anchored" data-anchor-id="visualising-year-2019-to-2023-by-variables">Visualising year 2019 to 2023 by Variables</h2>
<p>Total Revenue from foreign</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the map</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>equal_TotRev <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Thai_total_for_prov) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"total_for_revenue"</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">palette =</span> <span class="st">"Blues"</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Total Revenue "</span>) <span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal quantile Distribution of Total Foreign Revenue by Provinces 2019 to 2023"</span>,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">0.6</span>,</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.45</span>,</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>()</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>quantile_TotRev<span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Thai_total_for_prov) <span class="sc">+</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"total_for_revenue"</span>,</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="st">"equal"</span>,</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">palette =</span> <span class="st">"Blues"</span>,</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Total Revenue"</span>) <span class="sc">+</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal Interval of Total Foreign Revenue by Provinces 2019 to 2023"</span>,</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">0.6</span>,</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.45</span>,</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>()</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(equal_TotRev, </span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>             quantile_TotRev, </span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="dv">1</span>, </span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_home_02_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Amount of Foregin Tourist Spending.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the map</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>equal_nofor <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Thai_total_for_prov) <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"total_no_for_tourist"</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">palette =</span> <span class="st">"Blues"</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Total no. of Foreign Tourist"</span>) <span class="sc">+</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal quantile Distribution of Total no. of Foreign Tourist by Provinces 2019 to 2023"</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">0.6</span>,</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.45</span>,</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>()</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>quantil_nofor<span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Thai_total_for_prov) <span class="sc">+</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"total_no_for_tourist"</span>,</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="st">"equal"</span>,</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">palette =</span> <span class="st">"Blues"</span>,</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Total no. of Foreign Tourist"</span>) <span class="sc">+</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal Interval of Total no. of Foreign Tourist by Provinces 2019 to 2023"</span>,</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">0.6</span>,</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.45</span>,</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>()</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(equal_nofor, </span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>             quantil_nofor, </span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="dv">1</span>, </span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_home_02_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the map</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>equal_Amt <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Thai_total_for_prov) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"Amt_rev_per_for_tourist"</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">palette =</span> <span class="st">"Blues"</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Amount of reveune per foreign Touristt"</span>) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal quantile Distribution of Amount of reveune per foreign Touristby Provinces 2019 to 2023"</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">0.6</span>,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.45</span>,</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>()</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>quantil_Amt<span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Thai_total_for_prov) <span class="sc">+</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"Amt_rev_per_for_tourist"</span>,</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="st">"equal"</span>,</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">palette =</span> <span class="st">"Blues"</span>,</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Amount of reveune per foreign Tourist"</span>) <span class="sc">+</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal Interval of Amount of reveune per foreign Tourist by Provinces 2019 to 2023"</span>,</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">0.6</span>,</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.45</span>,</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>()</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(equal_Amt, </span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>             quantil_Amt, </span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="dv">1</span>, </span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_home_02_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="analyising-if-tourist-hotspot-is-related-to-space" class="level1">
<h1>Analyising if Tourist hotspot is related to space</h1>
<p>To start of our analysis we will start by analysing if the tourist hotspot is related spatially.</p>
<p>given that phunket is a offshore island and has the one of the top 3 provicnes, hence contigunity matrix will not be suitable, we will need to use distance based matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>top_3_revenue <span class="ot">&lt;-</span> Thai_total_for_prov <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_for_revenue)) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>top_3_tourists <span class="ot">&lt;-</span> Thai_total_for_prov <span class="sc">%&gt;%</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_no_for_tourist)) <span class="sc">%&gt;%</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>top_3_revenue_per_tourist <span class="ot">&lt;-</span> Thai_total_for_prov <span class="sc">%&gt;%</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Amt_rev_per_for_tourist)) <span class="sc">%&gt;%</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(top_3_revenue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 3 features and 7 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 418207.3 ymin: 826705.1 xmax: 794817.5 ymax: 1543363
Projected CRS: WGS 84 / UTM zone 47N
  Shape_Leng Shape_Area   ADM1_EN       date total_for_revenue
1   2.417227 0.13133873   Bangkok 2019-02-18      1.106223e+12
2   2.920196 0.04494432    Phuket 2019-02-18      7.315906e+11
3   6.091786 0.37563008 Chon Buri 2019-02-18      2.999981e+11
  total_no_for_tourist Amt_rev_per_for_tourist                       geometry
1             44452634                24885.43 MULTIPOLYGON (((674339.8 15...
2             17525594                41744.13 MULTIPOLYGON (((424349 8267...
3             14660424                20463.13 MULTIPOLYGON (((714273.8 13...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(top_3_tourists)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 3 features and 7 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 418207.3 ymin: 826705.1 xmax: 794817.5 ymax: 1543363
Projected CRS: WGS 84 / UTM zone 47N
  Shape_Leng Shape_Area   ADM1_EN       date total_for_revenue
1   2.417227 0.13133873   Bangkok 2019-02-18      1.106223e+12
2   2.920196 0.04494432    Phuket 2019-02-18      7.315906e+11
3   6.091786 0.37563008 Chon Buri 2019-02-18      2.999981e+11
  total_no_for_tourist Amt_rev_per_for_tourist                       geometry
1             44452634                24885.43 MULTIPOLYGON (((674339.8 15...
2             17525594                41744.13 MULTIPOLYGON (((424349 8267...
3             14660424                20463.13 MULTIPOLYGON (((714273.8 13...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(top_3_revenue_per_tourist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 3 features and 7 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 418207.3 ymin: 826705.1 xmax: 794817.5 ymax: 1543363
Projected CRS: WGS 84 / UTM zone 47N
  Shape_Leng Shape_Area   ADM1_EN       date total_for_revenue
1   2.920196 0.04494432    Phuket 2019-02-18      7.315906e+11
2   2.417227 0.13133873   Bangkok 2019-02-18      1.106223e+12
3   6.091786 0.37563008 Chon Buri 2019-02-18      2.999981e+11
  total_no_for_tourist Amt_rev_per_for_tourist                       geometry
1             17525594                41744.13 MULTIPOLYGON (((424349 8267...
2             44452634                24885.43 MULTIPOLYGON (((674339.8 15...
3             14660424                20463.13 MULTIPOLYGON (((714273.8 13...</code></pre>
</div>
</div>
<section id="calculating-using-the-distance-based-matrix" class="level2">
<h2 class="anchored" data-anchor-id="calculating-using-the-distance-based-matrix">Calculating using the distance based matrix:</h2>
<section id="fixed-distance-matrix" class="level3">
<h3 class="anchored" data-anchor-id="fixed-distance-matrix">Fixed Distance Matrix:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming Thai_total_for_pro has a geometry column in a projected CRS</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>Thai_total_for_prov <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(Thai_total_for_prov, <span class="at">crs =</span> <span class="dv">4326</span>) <span class="co"># WGS84 CRS</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>longitude <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(Thai_total_for_prov<span class="sc">$</span>geometry, <span class="sc">~</span><span class="fu">st_centroid</span>(.x)[[<span class="dv">1</span>]])</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>latitude <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(Thai_total_for_prov<span class="sc">$</span>geometry, <span class="sc">~</span><span class="fu">st_centroid</span>(.x)[[<span class="dv">2</span>]])</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">cbind</span>(longitude, latitude)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(coords)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     longitude latitude
[1,]  100.6235 13.77183
[2,]  100.7102 13.59651
[3,]  100.3928 13.92416
[4,]  100.6824 14.06513
[5,]  100.5266 14.34535
[6,]  100.3485 14.62354</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>k1 <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(coords))</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>k1dists <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">nbdists</span>(k1, coords, <span class="at">longlat =</span> <span class="cn">TRUE</span>))</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(k1dists)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  21.55   51.92   64.33   63.24   76.77  110.94 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>Thai_total_for_prov<span class="sc">$</span>ADM1_EN[<span class="fu">match</span>(<span class="fu">max</span>(k1dists), k1dists)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Prachuap Khiri Khan"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>wm_d111 <span class="ot">&lt;-</span> <span class="fu">dnearneigh</span>(coords, <span class="dv">0</span>, <span class="dv">111</span>, <span class="at">longlat =</span> <span class="cn">TRUE</span>) <span class="co">#based on the max distance from the fix distance neigh</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>wm_d111</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 77 
Number of nonzero links: 350 
Percentage nonzero weights: 5.903188 
Average number of links: 4.545455 
2 disjoint connected subgraphs</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wm_d111)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 77
 $ : int [1:12] 2 3 4 5 6 10 11 15 17 59 ...
 $ : int [1:10] 1 3 4 5 11 15 17 59 60 61
 $ : int [1:13] 1 2 4 5 6 8 10 17 56 58 ...
 $ : int [1:14] 1 2 3 5 6 8 10 15 16 17 ...
 $ : int [1:13] 1 2 3 4 6 7 8 9 10 17 ...
 $ : int [1:11] 1 3 4 5 7 8 9 10 17 58 ...
 $ : int [1:7] 5 6 8 9 10 17 48
 $ : int [1:10] 3 4 5 6 7 9 10 48 49 58
 $ : int [1:7] 5 6 7 8 48 49 58
 $ : int [1:9] 1 3 4 5 6 7 8 16 17
 $ : int [1:6] 1 2 12 13 15 16
 $ : int [1:3] 11 13 15
 $ : int [1:5] 11 12 14 15 18
 $ : int 13
 $ : int [1:9] 1 2 4 11 12 13 16 17 18
 $ : int [1:6] 4 10 11 15 17 18
 $ : int [1:10] 1 2 3 4 5 6 7 10 15 16
 $ : int [1:3] 13 15 16
 $ : int 20
 $ : int [1:2] 19 21
 $ : int [1:2] 20 22
 $ : int [1:2] 21 23
 $ : int [1:2] 22 26
 $ : int [1:3] 26 34 38
 $ : int [1:2] 29 55
 $ : int [1:4] 23 24 34 38
 $ : int [1:2] 32 36
 $ : int [1:4] 29 30 31 32
 $ : int [1:3] 25 28 33
 $ : int [1:3] 28 32 36
 $ : int 28
 $ : int [1:3] 27 28 30
 $ : int [1:3] 29 34 35
 $ : int [1:5] 24 26 33 35 38
 $ : int [1:4] 33 34 36 38
 $ : int [1:4] 27 30 35 37
 $ : int [1:2] 36 38
 $ : int [1:5] 24 26 34 35 37
 $ : int [1:3] 40 41 47
 $ : int [1:2] 39 41
 $ : int [1:3] 39 40 43
 $ : int [1:3] 43 52 53
 $ : int [1:4] 41 42 44 52
 $ : int [1:2] 43 45
 $ : int [1:2] 44 46
 $ : int 45
 $ : int 39
 $ : int [1:6] 7 8 9 49 50 54
 $ : int [1:6] 8 9 48 50 57 58
 $ : int [1:5] 48 49 51 52 54
 $ : int 50
 $ : int [1:4] 42 43 50 53
 $ : int [1:4] 42 52 54 55
 $ : int [1:4] 48 50 53 55
 $ : int [1:3] 25 53 54
 $ : int [1:5] 3 59 60 61 62
 $ : int [1:2] 49 58
 $ : int [1:9] 3 4 5 6 8 9 49 57 59
 $ : int [1:10] 1 2 3 4 5 6 56 58 60 61
 $ : int [1:9] 1 2 3 4 5 56 59 61 62
 $ : int [1:8] 1 2 3 4 56 59 60 62
 $ : int [1:4] 56 60 61 63
 $ : int 62
 $ : int [1:4] 65 68 73 74
 $ : int [1:5] 64 66 67 68 73
 $ : int [1:3] 65 67 68
 $ : int [1:2] 65 66
 $ : int [1:4] 64 65 66 69
 $ : int [1:2] 68 70
 $ : int 69
 $ : int [1:3] 72 74 75
 $ : int [1:3] 71 73 74
 $ : int [1:4] 64 65 72 74
 $ : int [1:4] 64 71 72 73
 $ : int [1:3] 71 76 77
 $ : int [1:2] 75 77
 $ : int [1:2] 75 76
 - attr(*, "class")= chr "nb"
 - attr(*, "region.id")= chr [1:77] "1" "2" "3" "4" ...
 - attr(*, "call")= language dnearneigh(x = coords, d1 = 0, d2 = 111, longlat = TRUE)
 - attr(*, "dnn")= num [1:2] 0 111
 - attr(*, "bounds")= chr [1:2] "GE" "LE"
 - attr(*, "nbtype")= chr "distance"
 - attr(*, "sym")= logi TRUE</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(Thai_total_for_prov<span class="sc">$</span>ADM1_EN, <span class="fu">card</span>(wm_d111))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          
                           1 2 3 4 5 6 7 8 9 10 11 12 13 14
  Amnat Charoen            0 0 0 1 0 0 0 0 0  0  0  0  0  0
  Ang Thong                0 0 0 0 0 0 0 0 0  0  1  0  0  0
  Bangkok                  0 0 0 0 0 0 0 0 0  0  0  1  0  0
  Bueng Kan                0 1 0 0 0 0 0 0 0  0  0  0  0  0
  Buri Ram                 0 1 0 0 0 0 0 0 0  0  0  0  0  0
  Chachoengsao             0 0 0 0 0 0 0 0 1  0  0  0  0  0
  Chai Nat                 0 0 0 0 0 0 1 0 0  0  0  0  0  0
  Chaiyaphum               0 1 0 0 0 0 0 0 0  0  0  0  0  0
  Chanthaburi              0 0 0 0 1 0 0 0 0  0  0  0  0  0
  Chiang Mai               0 0 1 0 0 0 0 0 0  0  0  0  0  0
  Chiang Rai               1 0 0 0 0 0 0 0 0  0  0  0  0  0
  Chon Buri                0 0 0 0 0 1 0 0 0  0  0  0  0  0
  Chumphon                 1 0 0 0 0 0 0 0 0  0  0  0  0  0
  Kalasin                  0 0 0 1 0 0 0 0 0  0  0  0  0  0
  Kamphaeng Phet           0 0 0 0 1 0 0 0 0  0  0  0  0  0
  Kanchanaburi             0 1 0 0 0 0 0 0 0  0  0  0  0  0
  Khon Kaen                0 0 1 0 0 0 0 0 0  0  0  0  0  0
  Krabi                    0 0 0 0 1 0 0 0 0  0  0  0  0  0
  Lampang                  0 0 1 0 0 0 0 0 0  0  0  0  0  0
  Lamphun                  0 1 0 0 0 0 0 0 0  0  0  0  0  0
  Loei                     1 0 0 0 0 0 0 0 0  0  0  0  0  0
  Lop Buri                 0 0 0 0 0 0 1 0 0  0  0  0  0  0
  Mae Hong Son             1 0 0 0 0 0 0 0 0  0  0  0  0  0
  Maha Sarakham            0 0 1 0 0 0 0 0 0  0  0  0  0  0
  Mukdahan                 0 0 0 0 1 0 0 0 0  0  0  0  0  0
  Nakhon Nayok             0 0 0 0 0 0 0 0 0  1  0  0  0  0
  Nakhon Pathom            0 0 0 0 0 0 0 0 0  1  0  0  0  0
  Nakhon Phanom            0 1 0 0 0 0 0 0 0  0  0  0  0  0
  Nakhon Ratchasima        1 0 0 0 0 0 0 0 0  0  0  0  0  0
  Nakhon Sawan             0 0 0 0 0 1 0 0 0  0  0  0  0  0
  Nakhon Si Thammarat      0 0 0 1 0 0 0 0 0  0  0  0  0  0
  Nan                      0 1 0 0 0 0 0 0 0  0  0  0  0  0
  Narathiwat               0 1 0 0 0 0 0 0 0  0  0  0  0  0
  Nong Bua Lam Phu         0 0 0 1 0 0 0 0 0  0  0  0  0  0
  Nong Khai                0 0 1 0 0 0 0 0 0  0  0  0  0  0
  Nonthaburi               0 0 0 0 0 0 0 0 0  0  0  0  1  0
  Pathum Thani             0 0 0 0 0 0 0 0 0  0  0  0  0  1
  Pattani                  0 0 1 0 0 0 0 0 0  0  0  0  0  0
  Phangnga                 0 0 1 0 0 0 0 0 0  0  0  0  0  0
  Phatthalung              0 0 0 1 0 0 0 0 0  0  0  0  0  0
  Phayao                   0 1 0 0 0 0 0 0 0  0  0  0  0  0
  Phetchabun               0 0 1 0 0 0 0 0 0  0  0  0  0  0
  Phetchaburi              0 0 0 1 0 0 0 0 0  0  0  0  0  0
  Phichit                  0 0 0 1 0 0 0 0 0  0  0  0  0  0
  Phitsanulok              0 0 0 1 0 0 0 0 0  0  0  0  0  0
  Phra Nakhon Si Ayutthaya 0 0 0 0 0 0 0 0 0  0  0  0  1  0
  Phrae                    0 0 0 1 0 0 0 0 0  0  0  0  0  0
  Phuket                   0 1 0 0 0 0 0 0 0  0  0  0  0  0
  Prachin Buri             0 0 0 0 0 1 0 0 0  0  0  0  0  0
  Prachuap Khiri Khan      1 0 0 0 0 0 0 0 0  0  0  0  0  0
  Ranong                   0 1 0 0 0 0 0 0 0  0  0  0  0  0
  Ratchaburi               0 0 0 0 1 0 0 0 0  0  0  0  0  0
  Rayong                   0 0 1 0 0 0 0 0 0  0  0  0  0  0
  Roi Et                   0 0 0 0 1 0 0 0 0  0  0  0  0  0
  Sa Kaeo                  0 0 1 0 0 0 0 0 0  0  0  0  0  0
  Sakon Nakhon             0 0 0 1 0 0 0 0 0  0  0  0  0  0
  Samut Prakan             0 0 0 0 0 0 0 0 0  1  0  0  0  0
  Samut Sakhon             0 0 0 0 0 0 0 0 1  0  0  0  0  0
  Samut Songkhram          0 0 0 0 0 0 0 1 0  0  0  0  0  0
  Saraburi                 0 0 0 0 0 0 0 0 1  0  0  0  0  0
  Satun                    0 0 1 0 0 0 0 0 0  0  0  0  0  0
  Si Sa Ket                0 1 0 0 0 0 0 0 0  0  0  0  0  0
  Sing Buri                0 0 0 0 0 0 0 0 0  1  0  0  0  0
  Songkhla                 0 0 1 0 0 0 0 0 0  0  0  0  0  0
  Sukhothai                0 0 0 1 0 0 0 0 0  0  0  0  0  0
  Suphan Buri              0 0 0 0 0 0 0 0 1  0  0  0  0  0
  Surat Thani              0 0 0 1 0 0 0 0 0  0  0  0  0  0
  Surin                    0 1 0 0 0 0 0 0 0  0  0  0  0  0
  Tak                      1 0 0 0 0 0 0 0 0  0  0  0  0  0
  Trang                    0 0 0 1 0 0 0 0 0  0  0  0  0  0
  Trat                     1 0 0 0 0 0 0 0 0  0  0  0  0  0
  Ubon Ratchathani         0 1 0 0 0 0 0 0 0  0  0  0  0  0
  Udon Thani               0 0 1 0 0 0 0 0 0  0  0  0  0  0
  Uthai Thani              0 0 0 0 0 1 0 0 0  0  0  0  0  0
  Uttaradit                0 0 1 0 0 0 0 0 0  0  0  0  0  0
  Yala                     0 1 0 0 0 0 0 0 0  0  0  0  0  0
  Yasothon                 0 0 1 0 0 0 0 0 0  0  0  0  0  0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>n_comp <span class="ot">&lt;-</span> <span class="fu">n.comp.nb</span>(wm_d111)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>n_comp<span class="sc">$</span>nc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(n_comp<span class="sc">$</span>comp.id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 1  2 
63 14 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Thai_total_for_prov<span class="sc">$</span>geometry, <span class="at">border=</span><span class="st">"lightgrey"</span>, <span class="at">main=</span><span class="st">"1st nearest neighbours"</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(k1, coords, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">length=</span><span class="fl">0.08</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Thai_total_for_prov<span class="sc">$</span>geometry, <span class="at">border=</span><span class="st">"lightgrey"</span>, <span class="at">main=</span><span class="st">"Distance link"</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wm_d111, coords, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_home_02_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="adaptive-distanace-weight-martix" class="level3">
<h3 class="anchored" data-anchor-id="adaptive-distanace-weight-martix">Adaptive Distanace weight martix</h3>
<p>Examining if Adpative distance weight martrix will be more suitable for the Analysis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>knn6 <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(coords, <span class="at">k=</span><span class="dv">6</span>))</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>knn6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 77 
Number of nonzero links: 462 
Percentage nonzero weights: 7.792208 
Average number of links: 6 
Non-symmetric neighbours list</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(knn6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 77
 $ : int [1:6] 2 3 4 5 59 60
 $ : int [1:6] 1 3 4 11 59 60
 $ : int [1:6] 1 2 4 5 59 60
 $ : int [1:6] 1 2 3 5 17 59
 $ : int [1:6] 1 3 4 6 8 10
 $ : int [1:6] 4 5 8 9 10 58
 $ : int [1:6] 5 6 8 9 10 17
 $ : int [1:6] 5 6 7 9 10 58
 $ : int [1:6] 6 7 8 48 49 58
 $ : int [1:6] 4 5 6 7 8 17
 $ : int [1:6] 1 2 12 13 15 16
 $ : int [1:6] 2 11 13 14 15 16
 $ : int [1:6] 11 12 14 15 16 18
 $ : int [1:6] 11 12 13 15 16 18
 $ : int [1:6] 1 2 11 12 16 17
 $ : int [1:6] 4 10 11 15 17 18
 $ : int [1:6] 1 4 5 10 15 16
 $ : int [1:6] 13 15 16 17 19 20
 $ : int [1:6] 10 16 17 18 20 25
 $ : int [1:6] 18 19 21 22 33 34
 $ : int [1:6] 20 22 24 26 33 34
 $ : int [1:6] 20 21 23 24 26 34
 $ : int [1:6] 21 22 24 26 34 38
 $ : int [1:6] 22 23 26 34 35 38
 $ : int [1:6] 7 19 28 29 33 55
 $ : int [1:6] 22 23 24 34 35 38
 $ : int [1:6] 28 30 32 35 36 37
 $ : int [1:6] 25 29 30 31 32 35
 $ : int [1:6] 25 28 30 33 34 35
 $ : int [1:6] 27 28 29 32 35 36
 $ : int [1:6] 28 30 32 42 53 55
 $ : int [1:6] 27 28 30 31 35 36
 $ : int [1:6] 20 21 24 29 34 35
 $ : int [1:6] 21 24 26 33 35 38
 $ : int [1:6] 24 29 33 34 36 38
 $ : int [1:6] 27 30 32 35 37 38
 $ : int [1:6] 24 26 27 35 36 38
 $ : int [1:6] 24 26 34 35 36 37
 $ : int [1:6] 40 41 43 45 46 47
 $ : int [1:6] 39 41 43 47 51 52
 $ : int [1:6] 39 40 42 43 45 52
 $ : int [1:6] 31 41 43 44 52 53
 $ : int [1:6] 40 41 42 44 45 52
 $ : int [1:6] 31 41 42 43 45 46
 $ : int [1:6] 39 41 42 43 44 46
 $ : int [1:6] 39 40 41 43 44 45
 $ : int [1:6] 39 40 41 43 45 46
 $ : int [1:6] 7 8 9 49 50 54
 $ : int [1:6] 8 9 48 50 57 58
 $ : int [1:6] 48 49 51 52 53 54
 $ : int [1:6] 40 48 49 50 52 54
 $ : int [1:6] 41 42 43 50 51 53
 $ : int [1:6] 31 42 50 52 54 55
 $ : int [1:6] 9 48 50 52 53 55
 $ : int [1:6] 7 25 31 48 53 54
 $ : int [1:6] 1 3 59 60 61 62
 $ : int [1:6] 6 9 49 56 58 59
 $ : int [1:6] 5 6 8 9 49 59
 $ : int [1:6] 1 3 4 5 60 61
 $ : int [1:6] 1 2 3 56 59 61
 $ : int [1:6] 1 3 56 59 60 62
 $ : int [1:6] 3 56 59 60 61 63
 $ : int [1:6] 2 56 60 61 62 70
 $ : int [1:6] 65 66 67 68 73 74
 $ : int [1:6] 64 66 67 68 73 74
 $ : int [1:6] 64 65 67 68 69 73
 $ : int [1:6] 64 65 66 68 73 74
 $ : int [1:6] 64 65 66 67 69 70
 $ : int [1:6] 64 65 66 67 68 70
 $ : int [1:6] 63 64 65 66 68 69
 $ : int [1:6] 72 73 74 75 76 77
 $ : int [1:6] 64 71 73 74 75 76
 $ : int [1:6] 64 65 67 71 72 74
 $ : int [1:6] 64 65 71 72 73 75
 $ : int [1:6] 71 72 73 74 76 77
 $ : int [1:6] 71 72 73 74 75 77
 $ : int [1:6] 71 72 73 74 75 76
 - attr(*, "region.id")= chr [1:77] "1" "2" "3" "4" ...
 - attr(*, "call")= language knearneigh(x = coords, k = 6)
 - attr(*, "sym")= logi FALSE
 - attr(*, "type")= chr "knn"
 - attr(*, "knn-k")= num 6
 - attr(*, "class")= chr "nb"</code></pre>
</div>
</div>
</section>
<section id="plotting-adaptive-distance-based-neighbours" class="level3">
<h3 class="anchored" data-anchor-id="plotting-adaptive-distance-based-neighbours">Plotting Adaptive Distance-based Neighbours</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Thai_total_for_prov<span class="sc">$</span>geometry, <span class="at">border=</span><span class="st">"lightgrey"</span>,<span class="at">main=</span><span class="st">"6 nearest neighbours"</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(knn6, coords, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.6</span>, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Thai_total_for_prov<span class="sc">$</span>geometry, <span class="at">border=</span><span class="st">"lightgrey"</span>, <span class="at">main=</span><span class="st">"Distance link"</span>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wm_d111, coords, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_home_02_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="weights-based-on-idw" class="level3">
<h3 class="anchored" data-anchor-id="weights-based-on-idw">Weights based on IDW</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>dist <span class="ot">&lt;-</span> <span class="fu">nbdists</span>(wm_d111, coords, <span class="at">longlat =</span> <span class="cn">TRUE</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>ids <span class="ot">&lt;-</span> <span class="fu">lapply</span>(dist, <span class="cf">function</span>(x) <span class="dv">1</span><span class="sc">/</span>(x))</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>ids</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
 [1] 0.046413915 0.033220882 0.030240349 0.015549299 0.010121521 0.009645788
 [7] 0.011152044 0.011280434 0.012985433 0.017019481 0.020074074 0.011959364

[[2]]
 [1] 0.04641391 0.02003043 0.01925519 0.01173811 0.01437242 0.01292025
 [7] 0.01178643 0.01332537 0.01850899 0.01177683

[[3]]
 [1] 0.033220882 0.020030425 0.028605483 0.020496673 0.012898506 0.009135287
 [7] 0.009723498 0.011096516 0.010200166 0.010696587 0.031941419 0.022846432
[13] 0.013273634

[[4]]
 [1] 0.030240349 0.019255190 0.028605483 0.028352781 0.013982995 0.009952248
 [7] 0.013918429 0.010525478 0.009564319 0.018047546 0.009552098 0.015509897
[13] 0.013379572 0.009245049

[[5]]
 [1] 0.01554930 0.01173811 0.02049667 0.02835278 0.02756509 0.01066480
 [7] 0.01522918 0.00975850 0.01630089 0.01408327 0.01339948 0.01533303
[13] 0.01084021

[[6]]
 [1] 0.01012152 0.01289851 0.01398300 0.02756509 0.01242005 0.03127482
 [7] 0.01510617 0.01388416 0.01005215 0.02029286 0.01224060

[[7]]
[1] 0.010664800 0.012420048 0.015632633 0.010571043 0.018342110 0.009750483
[7] 0.009705201

[[8]]
 [1] 0.009135287 0.009952248 0.015229183 0.031274815 0.015632633 0.023687661
 [7] 0.012698441 0.011395871 0.009504988 0.016885118

[[9]]
[1] 0.00975850 0.01510617 0.01057104 0.02368766 0.01608311 0.01570532 0.01681858

[[10]]
[1] 0.009645788 0.009723498 0.013918429 0.016300886 0.013884157 0.018342110
[7] 0.012698441 0.010682343 0.020717010

[[11]]
[1] 0.011152044 0.014372420 0.022408853 0.009398570 0.019262215 0.009391342

[[12]]
[1] 0.02240885 0.01310247 0.01201705

[[13]]
[1] 0.009398570 0.013102472 0.013223766 0.009026604 0.009765844

[[14]]
[1] 0.01322377

[[15]]
[1] 0.011280434 0.012920254 0.010525478 0.019262215 0.012017050 0.009026604
[7] 0.018323726 0.013713812 0.010089340

[[16]]
[1] 0.009564319 0.010682343 0.009391342 0.018323726 0.018187683 0.012788384

[[17]]
 [1] 0.012985433 0.011786435 0.011096516 0.018047546 0.014083270 0.010052154
 [7] 0.009750483 0.020717010 0.013713812 0.018187683

[[18]]
[1] 0.009765844 0.010089340 0.012788384

[[19]]
[1] 0.01082169

[[20]]
[1] 0.01082169 0.01322693

[[21]]
[1] 0.01322693 0.01301572

[[22]]
[1] 0.01301572 0.01140961

[[23]]
[1] 0.01140961 0.01137165

[[24]]
[1] 0.02317374 0.01778413 0.01311993

[[25]]
[1] 0.01096390 0.01302628

[[26]]
[1] 0.01137165 0.02317374 0.01006419 0.01283122

[[27]]
[1] 0.01045130 0.01178442

[[28]]
[1] 0.011054506 0.015302325 0.013301389 0.009883523

[[29]]
[1] 0.01096390 0.01105451 0.01291681

[[30]]
[1] 0.015302325 0.017483864 0.009781624

[[31]]
[1] 0.01330139

[[32]]
[1] 0.010451301 0.009883523 0.017483864

[[33]]
[1] 0.01291681 0.01429388 0.01177517

[[34]]
[1] 0.017784128 0.010064193 0.014293885 0.012343675 0.009660859

[[35]]
[1] 0.01177517 0.01234368 0.01149312 0.01043721

[[36]]
[1] 0.011784417 0.009781624 0.011493123 0.015545066

[[37]]
[1] 0.01554507 0.01093475

[[38]]
[1] 0.013119927 0.012831217 0.009660859 0.010437208 0.010934747

[[39]]
[1] 0.01276386 0.01025301 0.01358915

[[40]]
[1] 0.01276386 0.01580618

[[41]]
[1] 0.01025301 0.01580618 0.01663804

[[42]]
[1] 0.014433186 0.009934394 0.011816759

[[43]]
[1] 0.016638036 0.014433186 0.009206376 0.009069811

[[44]]
[1] 0.009206376 0.012495409

[[45]]
[1] 0.01249541 0.01316508

[[46]]
[1] 0.01316508

[[47]]
[1] 0.01358915

[[48]]
[1] 0.009705201 0.011395871 0.016083111 0.012326369 0.010254426 0.014915995

[[49]]
[1] 0.009504988 0.015705321 0.012326369 0.009205562 0.010358229 0.010768191

[[50]]
[1] 0.010254426 0.009205562 0.011111643 0.009533663 0.011527636

[[51]]
[1] 0.01111164

[[52]]
[1] 0.009934394 0.009069811 0.009533663 0.010632695

[[53]]
[1] 0.011816759 0.010632695 0.012094889 0.009899588

[[54]]
[1] 0.01491600 0.01152764 0.01209489 0.01161453

[[55]]
[1] 0.013026280 0.009899588 0.011614531

[[56]]
[1] 0.01020017 0.01402864 0.01456357 0.02304288 0.01533490

[[57]]
[1] 0.01035823 0.01098260

[[58]]
[1] 0.010696587 0.009552098 0.013399485 0.020292859 0.016885118 0.016818578
[7] 0.010768191 0.010982604 0.012579923

[[59]]
 [1] 0.01701948 0.01332537 0.03194142 0.01550990 0.01533303 0.01224060
 [7] 0.01402864 0.01257992 0.02441318 0.01646786

[[60]]
[1] 0.02007407 0.01850899 0.02284643 0.01337957 0.01084021 0.01456357 0.02441318
[8] 0.02941852 0.01061016

[[61]]
[1] 0.011959364 0.011776834 0.013273634 0.009245049 0.023042875 0.016467857
[7] 0.029418523 0.016262271

[[62]]
[1] 0.015334899 0.010610160 0.016262271 0.009013905

[[63]]
[1] 0.009013905

[[64]]
[1] 0.011326537 0.009359481 0.010554311 0.009956219

[[65]]
[1] 0.01132654 0.01135774 0.01298463 0.00997081 0.01085922

[[66]]
[1] 0.01135774 0.01270911 0.01174163

[[67]]
[1] 0.01298463 0.01270911

[[68]]
[1] 0.009359481 0.009970810 0.011741631 0.009085630

[[69]]
[1] 0.00908563 0.01730698

[[70]]
[1] 0.01730698

[[71]]
[1] 0.01448029 0.01204058 0.01090219

[[72]]
[1] 0.01448029 0.01168217 0.01319298

[[73]]
[1] 0.01055431 0.01085922 0.01168217 0.01903968

[[74]]
[1] 0.009956219 0.012040582 0.013192981 0.019039684

[[75]]
[1] 0.01090219 0.01634790 0.01359979

[[76]]
[1] 0.01634790 0.01841909

[[77]]
[1] 0.01359979 0.01841909</code></pre>
</div>
</div>
</section>
<section id="row-standardised-weights-martix" class="level3">
<h3 class="anchored" data-anchor-id="row-standardised-weights-martix">Row-Standardised Weights martix</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>rswm_d111 <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(wm_d111, <span class="at">style=</span><span class="st">"W"</span>, <span class="at">zero.policy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>rswm_d111</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 77 
Number of nonzero links: 350 
Percentage nonzero weights: 5.903188 
Average number of links: 4.545455 
2 disjoint connected subgraphs

Weights style: W 
Weights constants summary:
   n   nn S0       S1       S2
W 77 5929 77 49.37234 320.9424</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>rswm_d111<span class="sc">$</span>weights[<span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111
[8] 0.1111111 0.1111111</code></pre>
</div>
</div>
</section>
<section id="a-row-standardised-distance-weight-matrix-by-using-the-code-chunk-below." class="level3">
<h3 class="anchored" data-anchor-id="a-row-standardised-distance-weight-matrix-by-using-the-code-chunk-below.">a row standardised distance weight matrix by using the code chunk below.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>rswm_ids <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(wm_d111, <span class="at">glist=</span>ids, <span class="at">style=</span><span class="st">"B"</span>, <span class="at">zero.policy=</span><span class="cn">TRUE</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>rswm_ids</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 77 
Number of nonzero links: 350 
Percentage nonzero weights: 5.903188 
Average number of links: 4.545455 
2 disjoint connected subgraphs

Weights style: B 
Weights constants summary:
   n   nn       S0        S1       S2
B 77 5929 4.959897 0.1615711 2.249762</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>rswm_ids<span class="sc">$</span>weights[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
 [1] 0.046413915 0.033220882 0.030240349 0.015549299 0.010121521 0.009645788
 [7] 0.011152044 0.011280434 0.012985433 0.017019481 0.020074074 0.011959364</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">unlist</span>(rswm_ids<span class="sc">$</span>weights))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
0.009014 0.010641 0.012709 0.014171 0.015612 0.046414 </code></pre>
</div>
</div>
</section>
</section>
<section id="spatial-lag-with-row-standardized-weights" class="level2">
<h2 class="anchored" data-anchor-id="spatial-lag-with-row-standardized-weights">Spatial lag with row-standardized weights</h2>
<p>Finally, weâ€™ll compute the average neighbor GDPPC value for each polygon. These values are often referred to as spatially lagged values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>Total_rev.lag <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(rswm_d111, Thai_total_for_prov<span class="sc">$</span>total_for_revenue)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>Total_rev.lag</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  26372742183 141742764420  86319722423  80130369871  85744615092
 [6] 101601595109   1224806000   1109973470   1197995714 124166544744
[11] 186485341667 100246853333  63681146000    667780000 157932314222
[16]  50479650000 112264842470    436776667    385570000    801135000
[21]    230450000    487045000     56570000    233056667    427415000
[26]    377825000   1082065000   1150712500     29543333    722810000
[31]      4300000    596430000    208936667    159874000    188755000
[36]    535347500    337825000     95620000   1426283333  34237985000
[41]  22701123333   1076320000    728100000    228275000   6481360000
[46]    177920000  67625420000     40811667    588846667    456446000
[51]    110330000    395632500    535622500    429282500    405240000
[56]   1461507240     66590000   1559573800 112230000270 125369993800
[61] 140024310525   4636472500   5851100000  50554822500 180238900000
[66] 310504193333  75676205000  38084552500  54287605000    515730000
[71]    469696667  16827800000  23511807500  13057225000  18317020000
[76]   1471595000   1934215000</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>nb1 <span class="ot">&lt;-</span> wm_d111[[<span class="dv">1</span>]]</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>nb1 <span class="ot">&lt;-</span> Thai_total_for_prov<span class="sc">$</span>total_for_revenue[nb1]</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>nb1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]   4971250000    898464700   1569688000   7975590000     47170000
 [6]    249802000 299998120000     74660000    130190000    358861500
[11]     19620000    179490000</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>lag.list <span class="ot">&lt;-</span> <span class="fu">list</span>(Thai_total_for_prov<span class="sc">$</span>ADM1_EN, <span class="fu">lag.listw</span>(rswm_d111, Thai_total_for_prov<span class="sc">$</span>total_for_revenue))</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>lag.res <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(lag.list)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(lag.res) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ADM1_EN"</span>, <span class="st">"lag.total_for_revenue"</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>Thai_total_for_prov<span class="ot">&lt;-</span> <span class="fu">left_join</span>(Thai_total_for_prov,lag.res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>lag.list <span class="ot">&lt;-</span> <span class="fu">list</span>(Thai_total_for_prov<span class="sc">$</span>ADM1_EN, <span class="fu">lag.listw</span>(rswm_d111,Thai_total_for_prov<span class="sc">$</span>total_no_for_tourist))</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>lag.res <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(lag.list)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(lag.res) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ADM1_EN"</span>, <span class="st">"lag.total_no_for_tourist"</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>Thai_total_for_prov<span class="ot">&lt;-</span> <span class="fu">left_join</span>(Thai_total_for_prov,lag.res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>lag.list <span class="ot">&lt;-</span> <span class="fu">list</span>(Thai_total_for_prov<span class="sc">$</span>ADM1_EN, <span class="fu">lag.listw</span>(rswm_d111,Thai_total_for_prov<span class="sc">$</span>Amt_rev_per_for_tourist))</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>lag.res <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(lag.list)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(lag.res) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ADM1_EN"</span>, <span class="st">"lag.Amt_rev_per_for_tourist"</span>)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>Thai_total_for_prov<span class="ot">&lt;-</span> <span class="fu">left_join</span>(Thai_total_for_prov,lag.res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Thai_total_for_prov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 6 features and 10 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 100.1913 ymin: 13.47842 xmax: 100.9639 ymax: 14.80246
Geodetic CRS:  WGS 84
  Shape_Leng Shape_Area                  ADM1_EN       date total_for_revenue
1   2.417227 0.13133873                  Bangkok 2019-02-18      1.106223e+12
2   1.695100 0.07926199             Samut Prakan 2019-02-18      4.971250e+09
3   1.251111 0.05323766               Nonthaburi 2019-02-18      8.984647e+08
4   1.884945 0.12698345             Pathum Thani 2019-02-18      1.569688e+09
5   3.041716 0.21393797 Phra Nakhon Si Ayutthaya 2019-02-18      7.975590e+09
6   1.739908 0.07920961                Ang Thong 2019-02-18      4.717000e+07
  total_no_for_tourist Amt_rev_per_for_tourist lag.total_for_revenue
1             44452634               24885.431           26372742183
2              2183088                2277.164          141742764420
3               403338                2227.573           86319722423
4               750370                2091.885           80130369871
5              2961839                2692.783           85744615092
6                42073                1121.147          101601595109
  lag.total_no_for_tourist lag.Amt_rev_per_for_tourist
1                  1792514                    3617.747
2                  6360611                    6300.092
3                  3926935                    3849.991
4                  3625298                    3837.289
5                  3715284                    3765.752
6                  4456800                    4217.550
                        geometry
1 MULTIPOLYGON (((100.6139 13...
2 MULTIPOLYGON (((100.7306 13...
3 MULTIPOLYGON (((100.3415 14...
4 MULTIPOLYGON (((100.8916 14...
5 MULTIPOLYGON (((100.5131 14...
6 MULTIPOLYGON (((100.3332 14...</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>Total_rev <span class="ot">&lt;-</span> <span class="fu">qtm</span>(Thai_total_for_prov, <span class="st">"total_no_for_tourist"</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>lag_Total_rev <span class="ot">&lt;-</span> <span class="fu">qtm</span>(Thai_total_for_prov, <span class="st">"lag.total_no_for_tourist"</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(Total_rev, lag_Total_rev, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_home_02_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>Total_rev <span class="ot">&lt;-</span> <span class="fu">qtm</span>(Thai_total_for_prov, <span class="st">"Amt_rev_per_for_tourist"</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>lag_Total_rev <span class="ot">&lt;-</span> <span class="fu">qtm</span>(Thai_total_for_prov, <span class="st">"lag.Amt_rev_per_for_tourist"</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(Total_rev, lag_Total_rev, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_home_02_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>Total_rev <span class="ot">&lt;-</span> <span class="fu">qtm</span>(Thai_total_for_prov, <span class="st">"total_for_revenue"</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>lag_Total_rev <span class="ot">&lt;-</span> <span class="fu">qtm</span>(Thai_total_for_prov, <span class="st">"lag.total_for_revenue"</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(Total_rev, lag_Total_rev, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_home_02_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>###Computing Global Moranâ€™ I</p>
<p>Moranâ€™s I statistical test was pefromed by using moran.test() of spdep. Moranâ€™s I describe how features differ from the values in the study area as a whole. The Moran I statistic ranges from -1 to 1. If the Moran I is:</p>
<p>positive (I&gt;0): Clustered, observations tend to be similar</p>
<p>negative (I&lt;0): Disperse, observations tend to be dissimilar</p>
<p>approximately zero: observations arranged randomly over space</p>
<section id="for-total-revenue-from-foregin." class="level4">
<h4 class="anchored" data-anchor-id="for-total-revenue-from-foregin.">For Total Revenue from Foregin.</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.test</span>(Thai_total_for_prov<span class="sc">$</span>total_for_revenue, </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">listw=</span>rswm_d111, </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">zero.policy =</span> <span class="cn">TRUE</span>, </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">na.action=</span>na.omit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Moran I test under randomisation

data:  Thai_total_for_prov$total_for_revenue  
weights: rswm_d111    

Moran I statistic standard deviate = 1.0075, p-value = 0.1568
alternative hypothesis: greater
sample estimates:
Moran I statistic       Expectation          Variance 
      0.051767762      -0.013157895       0.004152612 </code></pre>
</div>
</div>
<p>The code below noted that the p-value is less than significant level at 0.05. Hence there is no relationship between the code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>bperm_tot <span class="ot">=</span> <span class="fu">moran.mc</span>(Thai_total_for_prov<span class="sc">$</span>total_for_revenue, </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">listw =</span> rswm_d111,</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">nsim =</span> <span class="dv">9999</span>,</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">zero.policy =</span> <span class="cn">TRUE</span>,</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">na.action =</span> na.omit)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>bperm_tot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  Thai_total_for_prov$total_for_revenue 
weights: rswm_d111  
number of simulations + 1: 10000 

statistic = 0.051768, observed rank = 9197, p-value = 0.0803
alternative hypothesis: greater</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.test</span>(Thai_total_for_prov<span class="sc">$</span>total_no_for_tourist, </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">listw=</span>rswm_d111, </span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">zero.policy =</span> <span class="cn">TRUE</span>, </span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">na.action=</span>na.omit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Moran I test under randomisation

data:  Thai_total_for_prov$total_no_for_tourist  
weights: rswm_d111    

Moran I statistic standard deviate = 1.6558, p-value = 0.04888
alternative hypothesis: greater
sample estimates:
Moran I statistic       Expectation          Variance 
      0.084003244      -0.013157895       0.003443176 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>bperm_noFor <span class="ot">=</span> <span class="fu">moran.mc</span>(Thai_total_for_prov<span class="sc">$</span>total_no_for_tourist, </span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">listw =</span> rswm_d111,</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">nsim =</span> <span class="dv">9999</span>,</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">zero.policy =</span> <span class="cn">TRUE</span>,</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">na.action =</span> na.omit)</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>bperm_noFor</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  Thai_total_for_prov$total_no_for_tourist 
weights: rswm_d111  
number of simulations + 1: 10000 

statistic = 0.084003, observed rank = 9393, p-value = 0.0607
alternative hypothesis: greater</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.test</span>(Thai_total_for_prov<span class="sc">$</span>Amt_rev_per_for_tourist, </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">listw=</span>rswm_d111, </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">zero.policy =</span> <span class="cn">TRUE</span>, </span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">na.action=</span>na.omit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Moran I test under randomisation

data:  Thai_total_for_prov$Amt_rev_per_for_tourist  
weights: rswm_d111    

Moran I statistic standard deviate = 4.1302, p-value = 1.812e-05
alternative hypothesis: greater
sample estimates:
Moran I statistic       Expectation          Variance 
      0.316242836      -0.013157895       0.006360718 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>bperm_Amt <span class="ot">=</span> <span class="fu">moran.mc</span>(Thai_total_for_prov<span class="sc">$</span>Amt_rev_per_for_tourist, </span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">listw =</span> rswm_d111,</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">nsim =</span> <span class="dv">9999</span>,</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">zero.policy =</span> <span class="cn">TRUE</span>,</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">na.action =</span> na.omit)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>bperm_Amt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  Thai_total_for_prov$Amt_rev_per_for_tourist 
weights: rswm_d111  
number of simulations + 1: 10000 

statistic = 0.31624, observed rank = 9966, p-value = 0.0034
alternative hypothesis: greater</code></pre>
</div>
</div>
<p>The Moranâ€™s I statistic of 0.31624 suggests a moderate positive spatial autocorrelation. This means that provinces in Thailand with higher revenue per tourist tend to be clustered together.</p>
<p>The statistical report on shows that the p-value is larger than alpha value of 0.05. Hence, we dont have statistical evidence to reject the null hypothesis that the spatial distribution of total foreign spedning in Thailand may resemble random distribution (i.e.&nbsp;independent from spatial). Because the Moranâ€™s I statistics is lesser than 0. We can infer that the spatial distribution shows sign of randomness and is not related to spatial.</p>
</section>
<section id="to-be-plotted-later" class="level4">
<h4 class="anchored" data-anchor-id="to-be-plotted-later">to be plotted later</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(bperm_Amt<span class="sc">$</span>res)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Simulated Moran's I"</span>)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>moran_amt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">Simulated Moran's I</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"grey"</span>, <span class="at">bins =</span> <span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">0.1</span>,<span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Frequency'</span>) <span class="sc">+</span> </span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">'red'</span>) <span class="sc">+</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span>  <span class="fl">0.316242836</span> , <span class="at">color =</span> <span class="st">'blue'</span>) <span class="sc">+</span> </span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Histogram of Monte Carlo Simulated </span><span class="sc">\n</span><span class="st">Moran's I (Amount Spent per foregin tourist"</span>) <span class="sc">+</span></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.35</span>, <span class="at">y =</span> <span class="dv">410</span>, <span class="at">label =</span> <span class="st">"Actual Moran's I"</span>, <span class="at">color =</span> <span class="st">'blue'</span>) </span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>moran_amt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_home_02_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">geary.test</span>(Thai_total_for_prov<span class="sc">$</span>total_for_revenue, <span class="at">listw =</span> rswm_d111)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Geary C test under randomisation

data:  Thai_total_for_prov$total_for_revenue 
weights: rswm_d111   

Geary C statistic standard deviate = 0.31193, p-value = 0.3775
alternative hypothesis: Expectation greater than statistic
sample estimates:
Geary C statistic       Expectation          Variance 
       0.95090914        1.00000000        0.02476803 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">geary.test</span>(Thai_total_for_prov<span class="sc">$</span>Amt_rev_per_for_tourist, <span class="at">listw =</span> rswm_d111)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Geary C test under randomisation

data:  Thai_total_for_prov$Amt_rev_per_for_tourist 
weights: rswm_d111   

Geary C statistic standard deviate = 3.1676, p-value = 0.0007686
alternative hypothesis: Expectation greater than statistic
sample estimates:
Geary C statistic       Expectation          Variance 
        0.6052675         1.0000000         0.0155293 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">geary.test</span>(Thai_total_for_prov<span class="sc">$</span>total_no_for_tourist, <span class="at">listw =</span> rswm_d111)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Geary C test under randomisation

data:  Thai_total_for_prov$total_no_for_tourist 
weights: rswm_d111   

Geary C statistic standard deviate = 0.15041, p-value = 0.4402
alternative hypothesis: Expectation greater than statistic
sample estimates:
Geary C statistic       Expectation          Variance 
       0.97495021        1.00000000        0.02773631 </code></pre>
</div>
</div>
<p>Computing Monte Carlo Gearyâ€™s C</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>bperm_G_Amt <span class="ot">=</span> <span class="fu">geary.mc</span>(Thai_total_for_prov<span class="sc">$</span>Amt_rev_per_for_tourist,</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">listw =</span> rswm_d111,</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>bperm_G_Amt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Geary C

data:  Thai_total_for_prov$Amt_rev_per_for_tourist 
weights: rswm_d111  
number of simulations + 1: 1000 

statistic = 0.60527, observed rank = 2, p-value = 0.002
alternative hypothesis: greater</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>moran_corr_Amt<span class="ot">&lt;-</span> <span class="fu">sp.correlogram</span>(knn6, <span class="co">#non-weighted spatial weights</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>                          Thai_total_for_prov<span class="sc">$</span>Amt_rev_per_for_tourist,</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">order =</span> <span class="dv">6</span>,</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">method =</span> <span class="st">'I'</span>, <span class="co">#Moran's I</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">style =</span> <span class="st">'W'</span>) <span class="co">#weighed</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(moran_corr_Amt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_home_02_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(moran_corr_Amt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial correlogram for Thai_total_for_prov$Amt_rev_per_for_tourist 
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided    
1 (77)  0.2453865  -0.0131579  0.0027804           4.9032       9.427e-07 ***
2 (77)  0.0738698  -0.0131579  0.0020621           1.9165         0.05531 .  
3 (77)  0.0477061  -0.0131579  0.0019047           1.3946         0.16314    
4 (77) -0.0017183  -0.0131579  0.0017711           0.2718         0.78576    
5 (77)  0.0487384  -0.0131579  0.0016770           1.5115         0.13067    
6 (77) -0.0481046  -0.0131579  0.0015967          -0.8746         0.38180    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="computing-local-morans-i" class="level4">
<h4 class="anchored" data-anchor-id="computing-local-morans-i">10.4.3 Computing local Moranâ€™s I</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>fips <span class="ot">&lt;-</span> <span class="fu">order</span>(Thai_total_for_prov<span class="sc">$</span>Amt_rev_per_for_tourist)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>localMI <span class="ot">&lt;-</span> <span class="fu">localmoran</span>(Thai_total_for_prov<span class="sc">$</span>Amt_rev_per_for_tourist, rswm_d111)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(localMI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Ii         E.Ii     Var.Ii       Z.Ii Pr(z != E(Ii))
1 -0.79945538 -0.129839209 0.61863368 -0.8513520      0.3945739
2 -0.08142930 -0.002888650 0.01951695 -0.5621970      0.5739818
3  0.10359129 -0.002987109 0.01481762  0.8755480      0.3812758
4  0.10931192 -0.003264935 0.01479610  0.9254978      0.3547070
5  0.09285128 -0.002128342 0.01056678  0.9239725      0.3555006
6  0.10366975 -0.005612861 0.03386023  0.5938901      0.5525856</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">printCoefmat</span>(<span class="fu">data.frame</span>(</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  localMI[fips,], </span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names=</span>Thai_total_for_prov<span class="sc">$</span>ADM1_EN[fips]),</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                  Ii        E.Ii      Var.Ii        Z.Ii
Pattani                  -1.1459e-01 -5.7584e-03  1.4303e-01 -2.8776e-01
Ang Thong                 1.0367e-01 -5.6129e-03  3.3860e-02  5.9389e-01
Nong Bua Lam Phu          2.2813e-01 -5.5605e-03  1.0219e-01  7.3106e-01
Chai Nat                  3.0376e-01 -4.6751e-03  4.7091e-02  1.4213e+00
Samut Songkhram          -4.6836e-02 -4.3454e-03  3.7756e-02 -2.1868e-01
Chachoengsao             -2.6271e-01 -4.3028e-03  3.2744e-02 -1.4280e+00
Lamphun                  -2.5432e-01 -4.1016e-03  1.5517e-01 -6.3521e-01
Nong Khai                 2.6455e-01 -4.0705e-03  1.0128e-01  8.4407e-01
Nakhon Phanom             2.3984e-01 -3.9054e-03  1.4778e-01  6.3407e-01
Sing Buri                 2.7645e-01 -3.8246e-03  2.5816e-02  1.7444e+00
Samut Sakhon             -1.2555e-02 -3.7769e-03  2.8758e-02 -5.1764e-02
Suphan Buri               2.4843e-01 -3.7623e-03  2.8647e-02  1.4900e+00
Lop Buri                  2.6624e-01 -3.7262e-03  3.7569e-02  1.3928e+00
Saraburi                  2.2844e-02 -3.6808e-03  2.8029e-02  1.5843e-01
Bueng Kan                 2.5105e-01 -3.6642e-03  1.3868e-01  6.8400e-01
Phichit                   2.0318e-01 -3.6016e-03  6.6318e-02  8.0297e-01
Uttaradit                 1.6941e-01 -3.3648e-03  8.3778e-02  5.9691e-01
Nakhon Sawan              2.5830e-01 -3.3224e-03  3.9663e-02  1.3137e+00
Nakhon Pathom             7.2667e-02 -3.2806e-03  2.2156e-02  5.1023e-01
Pathum Thani              1.0931e-01 -3.2649e-03  1.4796e-02  9.2550e-01
Maha Sarakham             1.8593e-01 -3.2442e-03  8.0785e-02  6.6558e-01
Kamphaeng Phet            1.9252e-01 -3.1626e-03  4.5961e-02  9.1275e-01
Mukdahan                  2.1262e-01 -3.0974e-03  4.5016e-02  1.0167e+00
Phayao                   -1.9352e-01 -3.0813e-03  1.1669e-01 -5.5750e-01
Nonthaburi                1.0359e-01 -2.9871e-03  1.4818e-02  8.7555e-01
Phatthalung              -1.2449e-01 -2.9558e-03  5.4461e-02 -5.2077e-01
Samut Prakan             -8.1429e-02 -2.8886e-03  1.9517e-02 -5.6220e-01
Chaiyaphum                1.3412e-01 -2.8884e-03  1.0940e-01  4.1422e-01
Roi Et                    2.0213e-01 -2.8802e-03  4.1868e-02  1.0019e+00
Ratchaburi                1.4897e-01 -2.6999e-03  3.9255e-02  7.6551e-01
Yasothon                  1.9401e-01 -2.5723e-03  6.4097e-02  7.7649e-01
Sa Kaeo                   9.7054e-02 -2.3492e-03  5.8550e-02  4.1081e-01
Surin                     1.4499e-01 -2.2140e-03  8.3915e-02  5.0815e-01
Si Sa Ket                 1.2147e-01 -2.2121e-03  8.3843e-02  4.2713e-01
Uthai Thani               1.8663e-01 -2.1408e-03  2.5587e-02  1.1801e+00
Phra Nakhon Si Ayutthaya  9.2851e-02 -2.1283e-03  1.0567e-02  9.2397e-01
Sakon Nakhon              1.6746e-01 -2.0560e-03  3.7916e-02  8.7057e-01
Phrae                     9.6788e-02 -1.8907e-03  3.4875e-02  5.2840e-01
Kalasin                   1.7202e-01 -1.8303e-03  3.3762e-02  9.4615e-01
Amnat Charoen             1.4329e-01 -1.7371e-03  3.2047e-02  8.1016e-01
Sukhothai                 1.4616e-01 -1.6607e-03  3.0638e-02  8.4452e-01
Loei                      2.0536e-01 -1.3131e-03  1.0098e-01  6.5040e-01
Buri Ram                  9.2148e-02 -1.1598e-03  4.4006e-02  4.4480e-01
Phetchabun                1.2203e-01 -1.1065e-03  2.7613e-02  7.4100e-01
Khon Kaen                 1.5210e-01 -1.0502e-03  2.6210e-02  9.4602e-01
Nakhon Nayok              3.1905e-02 -1.0330e-03  6.9926e-03  3.9390e-01
Phitsanulok               1.1328e-01 -9.6393e-04  1.7796e-02  8.5640e-01
Udon Thani                1.3299e-01 -8.1649e-04  2.0381e-02  9.3724e-01
Nakhon Ratchasima         6.2512e-02 -5.8334e-04  4.4891e-02  2.9780e-01
Nakhon Si Thammarat      -2.0195e-01 -4.7004e-04  8.6823e-03 -2.1623e+00
Ubon Ratchathani          7.0491e-02 -4.3726e-04  1.6603e-02  5.5047e-01
Tak                       8.7802e-02 -4.2203e-04  3.2482e-02  4.8951e-01
Prachin Buri             -3.3085e-03 -2.9059e-04  3.4796e-03 -5.1161e-02
Yala                      4.8842e-02 -2.0620e-04  7.8314e-03  5.5424e-01
Narathiwat                4.6718e-02 -1.8560e-04  7.0489e-03  5.5866e-01
Kanchanaburi              5.3225e-02 -1.6943e-04  6.4349e-03  6.6562e-01
Lampang                  -1.6864e-03 -9.6259e-05  2.4045e-03 -3.2428e-02
Nan                       3.2285e-02 -7.3659e-05  2.7979e-03  6.1175e-01
Satun                    -1.8910e-02 -6.0923e-05  1.5219e-03 -4.8316e-01
Chanthaburi               2.0069e-02 -1.2956e-05  1.8887e-04  1.4613e+00
Chumphon                  2.5527e-02 -2.5567e-04  1.9682e-02  1.8378e-01
Ranong                    2.2692e-01 -4.4125e-04  1.6754e-02  1.7565e+00
Mae Hong Son              2.9504e-01 -1.1533e-03  8.8703e-02  9.9449e-01
Rayong                    2.1776e-01 -1.5642e-03  3.9016e-02  1.1104e+00
Phetchaburi              -7.3425e-02 -2.5696e-03  4.7365e-02 -3.2557e-01
Trang                     1.5424e-01 -3.8950e-03  7.1700e-02  5.9058e-01
Songkhla                 -3.0634e-01 -7.6719e-03  1.9019e-01 -6.8484e-01
Chiang Rai               -4.2325e-01 -1.0065e-02  7.6724e-01 -4.7171e-01
Prachuap Khiri Khan       3.9720e-01 -1.0630e-02  8.0981e-01  4.5320e-01
Chiang Mai               -1.1553e-01 -1.3067e-02  3.2218e-01 -1.8052e-01
Phangnga                  3.8646e+00 -1.7556e-02  4.3089e-01  5.9141e+00
Trat                      4.4317e-02 -2.6245e-02  1.9678e+00  5.0301e-02
Krabi                     3.6114e+00 -4.5766e-02  6.3667e-01  4.5834e+00
Surat Thani               1.7625e+00 -7.1979e-02  1.2344e+00  1.6511e+00
Chon Buri                 9.4504e-01 -7.8029e-02  8.6168e-01  1.1021e+00
Bangkok                  -7.9946e-01 -1.2984e-01  6.1863e-01 -8.5135e-01
Phuket                    8.8083e+00 -4.4770e-01  9.3928e+00  3.0201e+00
                         Pr.z....E.Ii..
Pattani                          0.7735
Ang Thong                        0.5526
Nong Bua Lam Phu                 0.4647
Chai Nat                         0.1552
Samut Songkhram                  0.8269
Chachoengsao                     0.1533
Lamphun                          0.5253
Nong Khai                        0.3986
Nakhon Phanom                    0.5260
Sing Buri                        0.0811
Samut Sakhon                     0.9587
Suphan Buri                      0.1362
Lop Buri                         0.1637
Saraburi                         0.8741
Bueng Kan                        0.4940
Phichit                          0.4220
Uttaradit                        0.5506
Nakhon Sawan                     0.1890
Nakhon Pathom                    0.6099
Pathum Thani                     0.3547
Maha Sarakham                    0.5057
Kamphaeng Phet                   0.3614
Mukdahan                         0.3093
Phayao                           0.5772
Nonthaburi                       0.3813
Phatthalung                      0.6025
Samut Prakan                     0.5740
Chaiyaphum                       0.6787
Roi Et                           0.3164
Ratchaburi                       0.4440
Yasothon                         0.4375
Sa Kaeo                          0.6812
Surin                            0.6113
Si Sa Ket                        0.6693
Uthai Thani                      0.2379
Phra Nakhon Si Ayutthaya         0.3555
Sakon Nakhon                     0.3840
Phrae                            0.5972
Kalasin                          0.3441
Amnat Charoen                    0.4178
Sukhothai                        0.3984
Loei                             0.5154
Buri Ram                         0.6565
Phetchabun                       0.4587
Khon Kaen                        0.3441
Nakhon Nayok                     0.6937
Phitsanulok                      0.3918
Udon Thani                       0.3486
Nakhon Ratchasima                0.7659
Nakhon Si Thammarat              0.0306
Ubon Ratchathani                 0.5820
Tak                              0.6245
Prachin Buri                     0.9592
Yala                             0.5794
Narathiwat                       0.5764
Kanchanaburi                     0.5057
Lampang                          0.9741
Nan                              0.5407
Satun                            0.6290
Chanthaburi                      0.1439
Chumphon                         0.8542
Ranong                           0.0790
Mae Hong Son                     0.3200
Rayong                           0.2668
Phetchaburi                      0.7447
Trang                            0.5548
Songkhla                         0.4934
Chiang Rai                       0.6371
Prachuap Khiri Khan              0.6504
Chiang Mai                       0.8567
Phangnga                         0.0000
Trat                             0.9599
Krabi                            0.0000
Surat Thani                      0.0987
Chon Buri                        0.2704
Bangkok                          0.3946
Phuket                           0.0025</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>Thai_total_for_prov.localMI <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Thai_total_for_prov,localMI) <span class="sc">%&gt;%</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Pr.Ii =</span> Pr.z....E.Ii..)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Thai_total_for_prov.localMI) <span class="sc">+</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"Ii"</span>, </span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>,</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"RdBu"</span>,</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local moran statistics"</span>) <span class="sc">+</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_home_02_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Thai_total_for_prov.localMI) <span class="sc">+</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"Pr.Ii"</span>, </span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">breaks=</span><span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="cn">Inf</span>),</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-Blues"</span>, </span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Moran's I p-values"</span>) <span class="sc">+</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_home_02_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>nci <span class="ot">&lt;-</span> <span class="fu">moran.plot</span>(Thai_total_for_prov<span class="sc">$</span>lag.Amt_rev_per_for_tourist, rswm_d111,</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">labels=</span><span class="fu">as.character</span>(Thai_total_for_prov<span class="sc">$</span>ADM1_EN), </span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xlab=</span><span class="st">"Total Revenue 2019 to 2024"</span>, </span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylab=</span><span class="st">"Total Revenue 2019 to 2024"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_home_02_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>#Lisa Map:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Step 1</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>quadrant <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode=</span><span class="st">"numeric"</span>,<span class="at">length=</span><span class="fu">nrow</span>(localMI))</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Step 2</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>Thai_total_for_prov<span class="sc">$</span>Amt_rev_per_for_tourist <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(rswm_d111, Thai_total_for_prov<span class="sc">$</span>Amt_rev_per_for_tourist)</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>DV <span class="ot">&lt;-</span> Thai_total_for_prov<span class="sc">$</span>Amt_rev_per_for_tourist <span class="sc">-</span> <span class="fu">mean</span>(Thai_total_for_prov<span class="sc">$</span>Amt_rev_per_for_tourist)     </span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Step 3</span></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>LM_I <span class="ot">&lt;-</span> localMI[,<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">mean</span>(localMI[,<span class="dv">1</span>])</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Step 4</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>signif <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Step 5</span></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>quadrant[DV <span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_I<span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#low-low</span></span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>quadrant[DV <span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_I<span class="sc">&lt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co">#high-low</span></span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>quadrant[DV <span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_I<span class="sc">&lt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co">#low-high</span></span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>quadrant[DV <span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_I<span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co">#high-high</span></span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Step 6</span></span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a>quadrant[localMI[,<span class="dv">5</span>]<span class="sc">&gt;</span>signif]<span class="ot">&lt;-</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>Thai_total_for_prov.localMI<span class="sc">$</span>quadrant <span class="ot">&lt;-</span> quadrant</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#ffffff"</span>, <span class="st">"#2c7bb6"</span>, <span class="st">"#abd9e9"</span>, <span class="st">"#fdae61"</span>, <span class="st">"#d7191c"</span>)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"insignificant"</span>, <span class="st">"low-low"</span>, <span class="st">"low-high"</span>, <span class="st">"high-low"</span>, <span class="st">"high-high"</span>)</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>LISAmap <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Thai_total_for_prov.localMI) <span class="sc">+</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"quadrant"</span>, </span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"cat"</span>, </span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> colors[<span class="fu">c</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(quadrant)))<span class="sc">+</span><span class="dv">1</span>], </span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> clusters[<span class="fu">c</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(quadrant)))<span class="sc">+</span><span class="dv">1</span>],</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">popup.vars =</span> <span class="fu">c</span>(<span class="st">""</span>)) <span class="sc">+</span></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(Total_rev, LISAmap, </span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_home_02_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can also include the local Moranâ€™s I map and p-value map as shown below for easy comparison.</p>
</section>
</section>
<section id="hot-spot-area-analysis" class="level2">
<h2 class="anchored" data-anchor-id="hot-spot-area-analysis">5.2.2 Hot Spot Area Analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>knn_lw <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(knn6,</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">style =</span> <span class="st">"B"</span>,</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">zero.policy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>knn_lw</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 77 
Number of nonzero links: 462 
Percentage nonzero weights: 7.792208 
Average number of links: 6 
Non-symmetric neighbours list

Weights style: B 
Weights constants summary:
   n   nn  S0  S1    S2
B 77 5929 462 820 11500</code></pre>
</div>
</div>
</section>
<section id="gi-statistics-using-fixed-distance" class="level2">
<h2 class="anchored" data-anchor-id="gi-statistics-using-fixed-distance">Gi statistics using fixed distance</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>fips <span class="ot">&lt;-</span> <span class="fu">order</span>(Thai_total_for_prov<span class="sc">$</span>ADM1_EN)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>gi.fixed <span class="ot">&lt;-</span> <span class="fu">localG</span>(Thai_total_for_prov<span class="sc">$</span>Amt_rev_per_for_tourist, knn_lw)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>gi.fixed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -0.240709841 -0.092854385 -0.263147763 -0.352344270 -0.759758999
 [6] -1.133928940 -0.883587167 -1.107855016 -1.573885578 -0.966758224
[11]  1.302976954  1.349591934  1.077316088  1.438006646  0.762965325
[16]  0.338198636 -0.003039446  0.429865685 -0.470380151 -1.144409249
[21] -1.320827910 -1.362925987 -1.393495005 -1.433803860 -1.471691950
[26] -1.460021945 -1.619150613 -1.781573316 -1.460869377 -1.650051757
[31] -1.533205921 -1.757762325 -1.512115319 -1.467464857 -1.591678929
[36] -1.707294480 -1.581212506 -1.553550188  0.917655935  0.033031831
[41]  0.006574965 -1.254283357 -0.034416696 -0.704759521 -0.858259710
[46]  0.201310856  0.247485846 -1.675487769 -1.735145008 -1.612979583
[51] -0.978465783 -1.077840302 -1.557432884 -1.600646395 -1.662646426
[56] -0.286001913 -1.212302815 -1.179109096 -0.367413351 -0.275473316
[61] -0.534560696  0.074155711  0.180017254  5.675033786  5.387484138
[66]  6.084148349  5.512303933  6.394025029  6.200933968  5.975571543
[71]  0.298653773  0.850021776  3.262326683  2.392966107 -0.050244002
[76]  0.291916914  0.293877483
attr(,"internals")
              Gi      E(Gi)        V(Gi)        Z(Gi) Pr(z != E(Gi))
 [1,] 0.07286395 0.07894737 0.0006387159 -0.240709841   8.097800e-01
 [2,] 0.07658396 0.07894737 0.0006478473 -0.092854385   9.260192e-01
 [3,] 0.07229124 0.07894737 0.0006397994 -0.263147763   7.924367e-01
 [4,] 0.07003549 0.07894737 0.0006397415 -0.352344270   7.245801e-01
 [5,] 0.05973564 0.07894737 0.0006394127 -0.759758999   4.473987e-01
 [6,] 0.05022958 0.07894737 0.0006414019 -1.133928940   2.568244e-01
 [7,] 0.05676665 0.07894737 0.0006301622 -0.883587167   3.769191e-01
 [8,] 0.05114781 0.07894737 0.0006296658 -1.107855016   2.679244e-01
 [9,] 0.03944966 0.07894737 0.0006297924 -1.573885578   1.155139e-01
[10,] 0.05441090 0.07894737 0.0006441520 -0.966758224   3.336649e-01
[11,] 0.11215614 0.07894737 0.0006495792  1.302976954   1.925826e-01
[12,] 0.11333367 0.07894737 0.0006491813  1.349591934   1.771469e-01
[13,] 0.10639515 0.07894737 0.0006491248  1.077316088   2.813391e-01
[14,] 0.11548631 0.07894737 0.0006456397  1.438006646   1.504322e-01
[15,] 0.09839514 0.07894737 0.0006497258  0.762965325   4.454841e-01
[16,] 0.08753968 0.07894737 0.0006454700  0.338198636   7.352135e-01
[17,] 0.07887032 0.07894737 0.0006425336 -0.003039446   9.975749e-01
[18,] 0.08981750 0.07894737 0.0006394467  0.429865685   6.672933e-01
[19,] 0.06707169 0.07894737 0.0006374103 -0.470380151   6.380834e-01
[20,] 0.05006423 0.07894737 0.0006369802 -1.144409249   2.524540e-01
[21,] 0.04564894 0.07894737 0.0006355577 -1.320827910   1.865588e-01
[22,] 0.04453704 0.07894737 0.0006374308 -1.362925987   1.729058e-01
[23,] 0.04384870 0.07894737 0.0006344106 -1.393495005   1.634702e-01
[24,] 0.04288714 0.07894737 0.0006325246 -1.433803860   1.516282e-01
[25,] 0.04178184 0.07894737 0.0006377446 -1.471691950   1.411041e-01
[26,] 0.04218092 0.07894737 0.0006341392 -1.460021945   1.442840e-01
[27,] 0.03827080 0.07894737 0.0006311231 -1.619150613   1.054149e-01
[28,] 0.03403041 0.07894737 0.0006356430 -1.781573316   7.481884e-02
[29,] 0.04231984 0.07894737 0.0006286261 -1.460869377   1.440513e-01
[30,] 0.03757047 0.07894737 0.0006288117 -1.650051757   9.893235e-02
[31,] 0.04065408 0.07894737 0.0006237984 -1.533205921   1.252251e-01
[32,] 0.03478842 0.07894737 0.0006311276 -1.757762325   7.878796e-02
[33,] 0.04084812 0.07894737 0.0006348381 -1.512115319   1.305045e-01
[34,] 0.04203326 0.07894737 0.0006327752 -1.467464857   1.422496e-01
[35,] 0.03894330 0.07894737 0.0006316804 -1.591678929   1.114569e-01
[36,] 0.03598986 0.07894737 0.0006330839 -1.707294480   8.776733e-02
[37,] 0.03918149 0.07894737 0.0006324710 -1.581212506   1.138295e-01
[38,] 0.03987486 0.07894737 0.0006325458 -1.553550188   1.202917e-01
[39,] 0.10220743 0.07894737 0.0006424834  0.917655935   3.587990e-01
[40,] 0.07978934 0.07894737 0.0006497234  0.033031831   9.736492e-01
[41,] 0.07911441 0.07894737 0.0006454220  0.006574965   9.947540e-01
[42,] 0.04731117 0.07894737 0.0006361761 -1.254283357   2.097390e-01
[43,] 0.07807758 0.07894737 0.0006386911 -0.034416696   9.725449e-01
[44,] 0.06121885 0.07894737 0.0006327952 -0.704759521   4.809599e-01
[45,] 0.05707238 0.07894737 0.0006496185 -0.858259710   3.907491e-01
[46,] 0.08400346 0.07894737 0.0006308059  0.201310856   8.404555e-01
[47,] 0.08522658 0.07894737 0.0006437386  0.247485846   8.045322e-01
[48,] 0.03690581 0.07894737 0.0006296150 -1.675487769   9.383857e-02
[49,] 0.03533947 0.07894737 0.0006316241 -1.735145008   8.271512e-02
[50,] 0.03832720 0.07894737 0.0006341991 -1.612979583   1.067489e-01
[51,] 0.05437720 0.07894737 0.0006305579 -0.978465783   3.278440e-01
[52,] 0.05181814 0.07894737 0.0006335286 -1.077840302   2.811050e-01
[53,] 0.03975478 0.07894737 0.0006332706 -1.557432884   1.193677e-01
[54,] 0.03863294 0.07894737 0.0006343519 -1.600646395   1.094553e-01
[55,] 0.03710981 0.07894737 0.0006331882 -1.662646426   9.638323e-02
[56,] 0.07173253 0.07894737 0.0006363788 -0.286001913   7.748767e-01
[57,] 0.04848547 0.07894737 0.0006313812 -1.212302815   2.253965e-01
[58,] 0.04931553 0.07894737 0.0006315520 -1.179109096   2.383547e-01
[59,] 0.06963981 0.07894737 0.0006417432 -0.367413351   7.133107e-01
[60,] 0.07194855 0.07894737 0.0006454920 -0.275473316   7.829526e-01
[61,] 0.06535531 0.07894737 0.0006465119 -0.534560696   5.929537e-01
[62,] 0.08082514 0.07894737 0.0006412068  0.074155711   9.408865e-01
[63,] 0.08353590 0.07894737 0.0006497099  0.180017254   8.571390e-01
[64,] 0.22273569 0.07894737 0.0006419635  5.675033786   1.386613e-08
[65,] 0.21107974 0.07894737 0.0006015150  5.387484138   7.145078e-08
[66,] 0.20868397 0.07894737 0.0004547005  6.084148349   1.171121e-09
[67,] 0.21684934 0.07894737 0.0006258563  5.512303933   3.541666e-08
[68,] 0.24171481 0.07894737 0.0006480170  6.394025029   1.615750e-10
[69,] 0.23542860 0.07894737 0.0006368106  6.200933968   5.612906e-10
[70,] 0.23105621 0.07894737 0.0006479627  5.975571543   2.292849e-09
[71,] 0.08646667 0.07894737 0.0006338966  0.298653773   7.652042e-01
[72,] 0.10060090 0.07894737 0.0006489293  0.850021776   3.953130e-01
[73,] 0.16205508 0.07894737 0.0006489746  3.262326683   1.105017e-03
[74,] 0.13989989 0.07894737 0.0006487991  2.392966107   1.671278e-02
[75,] 0.07766852 0.07894737 0.0006478400 -0.050244002   9.599279e-01
[76,] 0.08629932 0.07894737 0.0006342884  0.291916914   7.703502e-01
[77,] 0.08634803 0.07894737 0.0006341749  0.293877483   7.688515e-01
attr(,"cluster")
 [1] Low  High Low  Low  Low  Low  Low  Low  Low  High High High High High High
[16] High Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low 
[31] Low  Low  Low  Low  Low  Low  Low  Low  Low  High High Low  Low  Low  High
[46] Low  High Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  High
[61] High Low  High High High High High High High High Low  High High High High
[76] Low  Low 
Levels: Low High
attr(,"gstari")
[1] FALSE
attr(,"call")
localG(x = Thai_total_for_prov$Amt_rev_per_for_tourist, listw = knn_lw)
attr(,"class")
[1] "localG"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>Thai_total_for_prov.gi <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Thai_total_for_prov, <span class="fu">as.matrix</span>(gi.fixed)) <span class="sc">%&gt;%</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">gstat_fixed =</span> as.matrix.gi.fixed.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>Gimap <span class="ot">&lt;-</span><span class="fu">tm_shape</span>(Thai_total_for_prov.gi) <span class="sc">+</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"gstat_fixed"</span>, </span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>,</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-RdBu"</span>,</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Gi"</span>) <span class="sc">+</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(Total_rev, Gimap, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_home_02_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="gi-statistics-using-adaptive-distance" class="level3">
<h3 class="anchored" data-anchor-id="gi-statistics-using-adaptive-distance">Gi statistics using adaptive distance</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>fips <span class="ot">&lt;-</span> <span class="fu">order</span>(Thai_total_for_prov<span class="sc">$</span>ADM1_EN)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>gi.adaptive <span class="ot">&lt;-</span> <span class="fu">localG</span>(Thai_total_for_prov<span class="sc">$</span>Amt_rev_per_for_tourist, knn_lw)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>Thai_total_for_pro_adp.gi <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Thai_total_for_prov, <span class="fu">as.matrix</span>(gi.adaptive)) <span class="sc">%&gt;%</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">gstat_adaptive =</span> as.matrix.gi.adaptive.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>Gimap_adap <span class="ot">&lt;-</span><span class="fu">tm_shape</span>(Thai_total_for_pro_adp.gi) <span class="sc">+</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"gstat_adaptive"</span>, </span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>,</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-RdBu"</span>,</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Gi"</span>) <span class="sc">+</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(Gimap_adap, Gimap, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_home_02_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="time-series" class="level2">
<h2 class="anchored" data-anchor-id="time-series">Time Series</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a> Tourdata_st <span class="ot">&lt;-</span> <span class="fu">spacetime</span>(tour_data_wide, SAB_1,</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.loc_col =</span> <span class="st">"ADM1_EN"</span>,</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.time_col =</span> <span class="st">"Date_tour"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is_spacetime_cube</span>(Tourdata_st)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<section id="emergering-hotspot" class="level3">
<h3 class="anchored" data-anchor-id="emergering-hotspot">Emergering Hotspot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>ehsa <span class="ot">&lt;-</span> <span class="fu">emerging_hotspot_analysis</span>(</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> Tourdata_st, </span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">.var =</span> <span class="st">"revenue_foreign"</span>, </span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> <span class="dv">1</span>, </span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">99</span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(ehsa ,<span class="st">"data/rds/ehsa.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>ehsa <span class="ot">&lt;-</span><span class="fu">read_rds</span>(<span class="st">"data/rds/ehsa.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>Thai_ehsa <span class="ot">&lt;-</span> SAB_1 <span class="sc">%&gt;%</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ehsa,</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">join_by</span>(ADM1_EN<span class="sc">==</span> location))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(Thai_ehsa ,<span class="st">"data/rds/Thai_ehsa.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>Thai_ehsa<span class="ot">&lt;-</span><span class="fu">read_rds</span>(<span class="st">"data/rds/Thai_ehsa.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>ehsa_sig <span class="ot">&lt;-</span> Thai_ehsa  <span class="sc">%&gt;%</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Thai_ehsa) <span class="sc">+</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(ehsa_sig) <span class="sc">+</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"classification"</span>) <span class="sc">+</span> </span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_home_02_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>